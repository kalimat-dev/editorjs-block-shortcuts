(function(n,r){typeof exports=="object"&&typeof module<"u"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(n=typeof globalThis<"u"?globalThis:n||self,r(n.BlockShortcut={}))})(this,function(n){"use strict";const r=class h{constructor({editor:e,blockConverters:t,maxShortcutLength:o}){this.editor=e,this.blocks=e.blocks,this.blockConverters=t,this.maxShortcutLength=o??10,this.addListeners()}addListeners(){document.querySelector(".codex-editor__redactor").addEventListener("keyup",t=>{if(t.code==="Space"){const o=this.blocks.getCurrentBlockIndex(),c=this.blocks.getBlockByIndex(o),f=c.holder.innerText,l=this.getCaretPosition();if(l>this.maxShortcutLength)return;const a=f.substr(0,l-1).trim();if(h.SPACES_REGEX.test(a))return;const d=this.getConverterInfoByShortcut(c.name,a);d&&(document.activeElement.innerHTML=document.activeElement.innerHTML.replace(a,"").replace(/(&nbsp;| )/,""),(async()=>{const u=await c.save(),s=d.converter(a,c.name,document.activeElement.innerHTML,u);(d.blockTypeComparator||this.defaultBlockTypeComparator)(s.type,c.name,u.data,s.data)&&(this.blocks.delete(o),this.blocks.insert(s.type,s.data,s.config,o,!0),this.editor.caret.setToBlock(o))})())}})}getConverterInfoByShortcut(e,t){return this.blockConverters.find(o=>o.shortcuts.some(i=>i instanceof RegExp&&i.test(t)?!0:i==t)?o.enabledFor?o.enabledFor.includes(e):!0:!1)}getCaretPosition(){document.execCommand("insertHTML",!1,'<a id="hidden">&#x200e</a>');const e=document.getElementById("hidden");if(!e)return 0;const t=e.parentElement.innerText.indexOf("â€Ž");return e.parentNode.removeChild(e),t}defaultBlockTypeComparator(e,t){return e!=t}};r.SPACES_REGEX=/^\s+$/;let m=r;n.BlockShortcuts=m,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
